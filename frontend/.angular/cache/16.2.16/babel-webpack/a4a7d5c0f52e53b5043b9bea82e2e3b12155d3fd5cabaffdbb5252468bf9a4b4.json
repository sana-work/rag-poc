{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { v4 as uuidv4 } from 'uuid';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./chat.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction AppComponent_div_7_div_7_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"span\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 16);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const cite_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cite_r4.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(Score: \", i0.ɵɵpipeBind2(5, 2, cite_r4.score, \"1.2-2\"), \")\");\n  }\n}\nfunction AppComponent_div_7_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h4\");\n    i0.ɵɵtext(2, \"Sources:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, AppComponent_div_7_div_7_li_4_Template, 6, 5, \"li\", 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const msg_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", msg_r1.citations);\n  }\n}\nfunction AppComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"div\", 10);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"titlecase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 11);\n    i0.ɵɵpipe(6, \"slice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, AppComponent_div_7_div_7_Template, 5, 1, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const msg_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngClass\", msg_r1.role);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 4, msg_r1.role));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind3(6, 6, msg_r1.content, 0, msg_r1.content.length), i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", msg_r1.citations && msg_r1.citations.length > 0);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(chatService) {\n      this.chatService = chatService;\n      this.messages = [];\n      this.inputMessage = '';\n      this.isLoading = false;\n      this.sessionId = uuidv4();\n    }\n    sendMessage() {\n      if (!this.inputMessage.trim()) return;\n      const userMsg = {\n        id: uuidv4(),\n        role: 'user',\n        content: this.inputMessage\n      };\n      this.messages.push(userMsg);\n      const assistantMsg = {\n        id: uuidv4(),\n        role: 'assistant',\n        content: '',\n        isStreaming: true\n      };\n      this.messages.push(assistantMsg);\n      const query = this.inputMessage;\n      this.inputMessage = '';\n      this.isLoading = true;\n      this.chatService.sendMessageStream(query, this.sessionId).subscribe({\n        next: event => {\n          if (event.type === 'meta') {\n            assistantMsg.citations = event.data.citations;\n          } else if (event.type === 'token') {\n            assistantMsg.content += event.data.text;\n          } else if (event.type === 'done') {\n            assistantMsg.isStreaming = false;\n            this.isLoading = false;\n          }\n        },\n        error: err => {\n          console.error('Stream error', err);\n          assistantMsg.content += '\\n[Error: Connection failed]';\n          assistantMsg.isStreaming = false;\n          this.isLoading = false;\n        }\n      });\n    }\n    static {\n      this.ɵfac = function AppComponent_Factory(t) {\n        return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.ChatService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AppComponent,\n        selectors: [[\"app-root\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 12,\n        vars: 5,\n        consts: [[1, \"chat-container\"], [1, \"header\"], [1, \"status-indicator\"], [1, \"messages-list\"], [\"class\", \"message\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"input-area\"], [\"type\", \"text\", \"placeholder\", \"Ask a question...\", 3, \"ngModel\", \"disabled\", \"ngModelChange\", \"keyup.enter\"], [3, \"disabled\", \"click\"], [1, \"message\", 3, \"ngClass\"], [1, \"message-content\"], [1, \"role-label\"], [1, \"text\", 3, \"innerHTML\"], [\"class\", \"citations\", 4, \"ngIf\"], [1, \"citations\"], [4, \"ngFor\", \"ngForOf\"], [1, \"cite-title\"], [1, \"cite-score\"]],\n        template: function AppComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\");\n            i0.ɵɵtext(3, \"Informational Assistant\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2);\n            i0.ɵɵtext(5);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 3);\n            i0.ɵɵtemplate(7, AppComponent_div_7_Template, 8, 10, \"div\", 4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 5)(9, \"input\", 6);\n            i0.ɵɵlistener(\"ngModelChange\", function AppComponent_Template_input_ngModelChange_9_listener($event) {\n              return ctx.inputMessage = $event;\n            })(\"keyup.enter\", function AppComponent_Template_input_keyup_enter_9_listener() {\n              return ctx.sendMessage();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_10_listener() {\n              return ctx.sendMessage();\n            });\n            i0.ɵɵtext(11, \" Send \");\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate1(\" \", ctx.isLoading ? \"Generating...\" : \"Ready\", \" \");\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngModel\", ctx.inputMessage)(\"disabled\", ctx.isLoading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"disabled\", ctx.isLoading || !ctx.inputMessage.trim());\n          }\n        },\n        dependencies: [CommonModule, i2.NgClass, i2.NgForOf, i2.NgIf, i2.SlicePipe, i2.DecimalPipe, i2.TitleCasePipe, FormsModule, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;max-width:900px;margin:0 auto;background-color:#f5f5f5;border-left:1px solid #ddd;border-right:1px solid #ddd}.header[_ngcontent-%COMP%]{padding:20px;background-color:#fff;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:#333}.messages-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:20px}.message[_ngcontent-%COMP%]{max-width:80%;padding:15px;border-radius:8px;line-height:1.5}.message.user[_ngcontent-%COMP%]{align-self:flex-end;background-color:#007bff;color:#fff}.message.assistant[_ngcontent-%COMP%]{align-self:flex-start;background-color:#fff;border:1px solid #e0e0e0;color:#333}.role-label[_ngcontent-%COMP%]{font-size:.8rem;opacity:.7;margin-bottom:5px;font-weight:700}.text[_ngcontent-%COMP%]{white-space:pre-wrap}.citations[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid rgba(0,0,0,.1);font-size:.85rem}.citations[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 5px}.citations[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px}.input-area[_ngcontent-%COMP%]{padding:20px;background:white;border-top:1px solid #eee;display:flex;gap:10px}input[_ngcontent-%COMP%]{flex:1;padding:12px;border:1px solid #ddd;border-radius:4px;font-size:1rem}button[_ngcontent-%COMP%]{padding:0 20px;background-color:#007bff;color:#fff;border:none;border-radius:4px;font-size:1rem;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}\"]\n      });\n    }\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}